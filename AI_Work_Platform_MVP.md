# AI Work Platform - 产品规划文档

## 📌 项目概述

**项目名称**：AI Work Platform（暂定）
**目标**：将 OpenClaw 从技术极客工具转型为面向大众的一键安装桌面应用
**MVP 范围**：漫剧制作场景的完整解决方案

---

## 🎯 产品定位

### 目标用户
- **主要用户**：内容创作者、自媒体运营、中小企业
- **次要用户**：技术开发者、AI 爱好者
- **排除**：不需要任何技术背景，开箱即用

### 核心价值
- 🔥 **一键安装**：傻瓜式安装，无需配置
- 🤖 **智能招聘**：发布职位描述，自动生成 Agent
- 🎬 **开箱即用**：内置官方技能，满足主流场景
- 🔄 **自然语言**：所有操作用自然语言描述
- 👥 **团队协作**：多个 Agent 协同工作

---

## 🏗️ 技术架构

### 技术栈选择

| 层级 | 技术选型 | 理由 |
|-----|---------|------|
| **前端框架** | Tauri + Vue 3 | 体积小、安全、跨平台、开发效率高 |
| **前端语言** | TypeScript | 类型安全、IDE 支持好、代码可维护 |
| **UI 组件库** | Element Plus | Vue 3 生态成熟、中文友好 |
| **后端框架** | Python + FastAPI | 高性能、异步支持、API 文档自动生成 |
| **Agent 引擎** | 参考OpenClaw架构 | 已验证的架构、复用后端逻辑 |
| **数据库** | SQLite + Redis | 轻量级（SQLite）+ 缓存（Redis） |
| **打包工具** | Tauri CLI | 官方支持、跨平台打包 |
| **安装包** | NSIS (Windows) | Windows 标准安装程序 |

### 系统架构

```
┌─────────────────────────────────────────────┐
│           桌面客户端（Tauri + Vue）          │
│                                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │ 首次设置 │  │ Agent管理 │  │ Flow编排 │ │
│  └──────────┘  └──────────┘  └──────────┘ │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │ 技能插件 │  │ 监控调试  │  │ 设置管理 │ │
│  └──────────┘  └──────────┘  └──────────┘ │
└─────────────────────────────────────────────┘
                    ↕ Tauri IPC
┌─────────────────────────────────────────────┐
│          后端服务（FastAPI + Python）        │
│                                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │Agent引擎 │  │ 技能管理  │  │ Flow引擎 │ │
│  └──────────┘  └──────────┘  └──────────┘ │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │Model管理 │  │ 存储引擎  │  │ 日志监控 │ │
│  └──────────┘  └──────────┘  └──────────┘ │
└─────────────────────────────────────────────┘
                    ↕ HTTP API
┌─────────────────────────────────────────────┐
│             LLM Provider 层                 │
│  ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐  │
│  │OpenAI │ │Claude │ │GLM-4  │ │其他   │  │
│  └───────┘ └───────┘ └───────┘ └───────┘  │
└─────────────────────────────────────────────┘
```

---

## 📦 功能模块设计

### 模块 1：用户设置（User Profile）

**功能描述**：用户首次打开软件时设置个人简介

**核心功能**：
1. 个人基本信息（姓名、职业、联系方式）
2. 工作偏好（工作时间、响应速度、风格偏好）
3. 技能标签（用户擅长的领域）
4. 目标设定（使用平台的主要目的）

**数据结构**：
```json
{
  "user_id": "uuid",
  "name": "张三",
  "profession": "内容创作者",
  "contact": {
    "email": "example@email.com",
    "wechat": "wxid_xxx"
  },
  "preferences": {
    "work_hours": "9:00-18:00",
    "response_style": "简洁",
    "language": "zh-CN"
  },
  "skills": ["文案写作", "视频剪辑", "AI工具使用"],
  "goals": ["制作漫剧", "提升效率"],
  "created_at": "2026-02-15T10:00:00Z"
}
```

**UI 流程**：
```
欢迎页 → 个人信息表单 → 技能标签选择 → 目标设定 → 完成
```

---

### 模块 2：Agent 模拟招聘系统

**功能描述**：发布职位描述，系统自动生成完整的 Agent 配置

**核心功能**：

#### 2.1 发布职位
- 职位名称（如：漫剧脚本师、角色配音师）
- 工作内容描述（自然语言）
- 技能要求（自然语言 + 标签）
- 工作风格要求（如：专业、幽默、严肃）
- 输出要求（如：每集 10 分钟）

#### 2.2 Agent 自动生成
AI 自动生成以下文件：
1. **灵魂（SOUL.md）**：Agent 的性格、价值观、行为准则
2. **头像**：根据职位和风格自动生成（或从预设库选择）
3. **个人信息（IDENTITY.md）**：姓名、职位、简介
4. **行为准则（RULES.md）**：工作边界、安全规则
5. **记忆系统（MEMORY.md）**：初始为空，预留框架
6. **推荐技能**：系统根据职位推荐相关 SKILL
7. **默认模型**：根据职位推荐最适合的 LLM

#### 2.3 手动调整
生成后用户可以自由修改上述所有内容

**示例流程**：

**用户输入**：
```
职位：漫剧脚本师
工作内容：负责漫剧故事创作，包括剧情大纲、分镜脚本、角色对话
技能要求：熟悉漫剧创作流程、有故事创作经验、了解二次元文化
工作风格：创意丰富、文笔流畅、符合二次元审美
输出要求：每集剧情大纲（500-1000字）、详细分镜脚本
```

**系统自动生成**：

**IDENTITY.md**：
```markdown
# IDENTITY.md - 漫剧脚本师 Agent

- **姓名**：星野
- **职位**：漫剧脚本师
- **简介**：创意丰富的二次元故事创作者，擅长将想象转化为生动的漫剧脚本
- **风格**：创意、流畅、二次元审美
```

**SOUL.md**：
```markdown
# SOUL.md - 星野的灵魂

## 核心性格
- 创意无限：总能想出新颖有趣的剧情
- 深入角色：能够理解并塑造丰富的角色性格
- 节奏感强：懂得如何控制故事节奏

## 行为准则
1. 保持创意，避免套路化
2. 尊重用户设定，不随意改动角色设定
3. 输出符合二次元审美和文化背景
4. 脚本要便于后续制作（配音、动画等）

## 安全边界
- 不生成违规内容
- 不涉及敏感话题
- 保持健康积极
```

**推荐 SKILL**：
- 漫剧故事生成（官方）
- 分镜脚本生成（官方）
- 角色对话优化（官方）
- 剧情节奏分析（官方）

**默认 Model**：GLM-4（适合中文创作）

---

### 模块 3：技能/插件系统

**功能描述**：系统内置官方技能（不可修改），用户也可通过自然语言创建自定义技能

#### 3.1 官方技能（漫剧制作场景）

| 技能名称 | 功能描述 | 依赖工具 |
|---------|---------|---------|
| **漫剧故事生成** | 根据用户提示生成剧情大纲 | 无 |
| **分镜脚本生成** | 根据剧情生成详细分镜 | 无 |
| **角色对话生成** | 根据角色设定生成对话 | 无 |
| **分镜转图片** | 将分镜描述转换为参考图 | image-generate |
| **语音合成** | 将对话转换为语音 | TTS 工具 |
| **视频生成** | 根据脚本和画面生成视频 | video-generate |
| **音效匹配** | 为场景匹配合适音效 | 音效库 API |
| **字幕生成** | 自动生成字幕 | 无 |

#### 3.2 自定义技能创建

**用户输入**（自然语言）：
```
我需要一个技能，可以根据文本描述生成合适的背景音乐推荐，
考虑场景的情绪、节奏、风格等因素。
```

**系统自动生成 SKILL.md**：
```markdown
# SKILL.md - 背景音乐推荐技能

## 功能描述
根据文本描述推荐合适的背景音乐，考虑情绪、节奏、风格等因素。

## 输入参数
- scene_description: 场景描述（文本）
- mood: 情绪（可选，如：悲伤、欢快、紧张）
- duration: 时长（可选，单位：秒）

## 输出结果
- 音乐推荐列表
- 每首音乐的详细信息（风格、节奏、适用场景）

## 工具依赖
- web_search: 搜索音乐库
- 外部音乐 API（可选）

## 使用流程
1. 分析场景描述，提取情绪和风格关键词
2. 根据情绪和风格搜索合适的音乐
3. 过滤并排序推荐结果
4. 返回推荐列表给用户
```

**技术实现**：
- 使用 LLM 分析用户需求
- 根据 SKILL 模板生成 SKILL.md
- 自动识别需要的工具
- 生成使用示例和测试用例

---

### 模块 4：Flow 工作流编排

**功能描述**：类似 Dify/Coze，但使用自然语言描述工作流，无需拖拽节点

#### 4.1 Flow 创建流程

**用户输入**（自然语言）：
```
制作一集漫剧：
1. 脚本师根据用户需求生成剧情大纲
2. 脚本师根据大纲生成详细分镜脚本
3. 画面师根据分镜生成分镜参考图
4. 配音师根据脚本生成角色配音
5. 视频师根据脚本和画面生成视频
6. 最后整合所有素材，输出成片
```

**系统自动解析为 Flow**：

```json
{
  "flow_id": "uuid",
  "name": "漫剧制作流程",
  "description": "从剧情到成片的完整制作流程",
  "agents": [
    {
      "agent_id": "script_writer",
      "agent_name": "星野（脚本师）",
      "tasks": [
        {
          "task_id": "generate_plot",
          "name": "生成剧情大纲",
          "input": "用户需求",
          "output": "剧情大纲",
          "skills": ["漫剧故事生成"]
        },
        {
          "task_id": "generate_storyboard",
          "name": "生成分镜脚本",
          "input": "剧情大纲",
          "output": "分镜脚本",
          "skills": ["分镜脚本生成"]
        }
      ]
    },
    {
      "agent_id": "artist",
      "agent_name": "月影（画面师）",
      "tasks": [
        {
          "task_id": "generate_images",
          "name": "生成分镜参考图",
          "input": "分镜脚本",
          "output": "分镜参考图",
          "skills": ["分镜转图片"]
        }
      ]
    },
    {
      "agent_id": "voice_actor",
      "agent_name": "云雀（配音师）",
      "tasks": [
        {
          "task_id": "generate_voice",
          "name": "生成角色配音",
          "input": "分镜脚本",
          "output": "角色配音",
          "skills": ["语音合成"]
        }
      ]
    },
    {
      "agent_id": "video_editor",
      "agent_name": "风华（视频师）",
      "tasks": [
        {
          "task_id": "generate_video",
          "name": "生成视频",
          "input": "分镜脚本 + 分镜参考图",
          "output": "视频素材",
          "skills": ["视频生成"]
        },
        {
          "task_id": "compile_final",
          "name": "整合成片",
          "input": "视频素材 + 角色配音",
          "output": "成片",
          "skills": ["视频编辑"]
        }
      ]
    }
  ],
  "connections": [
    {"from": "generate_plot", "to": "generate_storyboard"},
    {"from": "generate_storyboard", "to": "generate_images"},
    {"from": "generate_storyboard", "to": "generate_voice"},
    {"from": "generate_images", "to": "generate_video"},
    {"from": "generate_video", "to": "compile_final"},
    {"from": "generate_voice", "to": "compile_final"}
  ],
  "created_at": "2026-02-15T10:00:00Z"
}
```

#### 4.2 Flow 执行

- 按照依赖关系依次执行各个任务
- 支持并行执行（无依赖的任务）
- 实时显示执行进度和日志
- 支持暂停、继续、重试

---

### 模块 5：多 Provider/Model 管理

**功能描述**：支持多个 LLM Provider，每个 Provider 下有多个 Model，开箱即用

#### 5.1 默认配置（开箱即用）

```json
{
  "providers": [
    {
      "name": "OpenAI",
      "enabled": true,
      "models": [
        {
          "name": "gpt-4o",
          "enabled": true,
          "api_key": "",  // 用户需要配置
          "endpoint": "https://api.openai.com/v1"
        },
        {
          "name": "gpt-4o-mini",
          "enabled": true,
          "api_key": "",
          "endpoint": "https://api.openai.com/v1"
        }
      ]
    },
    {
      "name": "Anthropic",
      "enabled": true,
      "models": [
        {
          "name": "claude-3-5-sonnet",
          "enabled": true,
          "api_key": "",
          "endpoint": "https://api.anthropic.com"
        }
      ]
    },
    {
      "name": "智谱 AI",
      "enabled": true,
      "models": [
        {
          "name": "glm-4",
          "enabled": true,
          "api_key": "",
          "endpoint": "https://open.bigmodel.cn/api/paas/v4"
        }
      ]
    },
    {
      "name": "阿里云",
      "enabled": true,
      "models": [
        {
          "name": "qwen-max",
          "enabled": true,
          "api_key": "",
          "endpoint": "https://dashscope.aliyuncs.com/api/v1"
        }
      ]
    }
  ],
  "default_model": "glm-4"  // 默认使用智谱（国内友好）
}
```

#### 5.2 用户配置界面

- 显示所有 Provider 和 Model
- 启用/禁用 Provider 和 Model
- 配置 API Key（加密存储）
- 选择默认 Model
- 测试连接
- 显示 Model 价格和速率限制

---

### 模块 6：Agent 工作引擎

**功能描述**：模仿 OpenClaw 的 Agent 工作机制

#### 6.1 核心机制

1. **工具调用**：支持多种工具（web_search、tts、image_generate、video_generate 等）
2. **记忆管理**：长期记忆 + 短期记忆
3. **技能加载**：动态加载 SKILL.md
4. **消息路由**：支持多会话、跨会话消息
5. **计划任务**：支持定时任务（cron）
6. **安全防护**：参考 OpenClaw SOUL.md 的安全机制

#### 6.2 Agent 数据结构

每个 Agent 有独立的目录：

```
agents/
├── {agent_id}/
│   ├── SOUL.md              # 灵魂（性格、价值观）
│   ├── IDENTITY.md          # 身份信息
│   ├── RULES.md             # 行为准则
│   ├── MEMORY.md            # 长期记忆
│   ├── SKILLS.md            # 关联的技能列表
│   ├── CONFIG.json          # 配置（默认模型、工具权限等）
│   ├── tools/               # Agent 专用工具（可选）
│   └── memory/              # 记忆存储
│       ├── 2026-02-15.md    # 每日记忆
│       └── ...
```

---

## 🎨 UI/UX 设计

### 主界面布局

```
┌─────────────────────────────────────────────┐
│  AI Work Platform                  _ □ ✕     │
├─────────────────────────────────────────────┤
│  [导航栏]                                   │
│  ├── 用户设置 ├── Agent 管理 ├── Flow 编排 │
│  ├── 技能插件 ├── 监控调试 ├── 设置         │
├──────────────┬──────────────────────────────┤
│  侧边栏       │ 主内容区                    │
│              │                              │
│  ├─ 用户设置  │  用户配置表单                │
│  ├─ Agent列表 │  Agent 卡片列表             │
│  ├─ Flow列表  │  Flow 可视化展示            │
│  ├─ 技能列表  │  技能详情和文档             │
│  └─ 日志监控  │  实时日志和状态             │
│              │                              │
└──────────────┴──────────────────────────────┘
```

### Agent 创建流程

```
1. 点击"创建 Agent"
2. 填写职位信息表单
3. 系统自动生成 Agent 配置
4. 预览生成的配置
5. 手动调整（可选）
6. 保存
```

### Flow 创建流程

```
1. 点击"创建 Flow"
2. 选择需要的 Agent（可多选）
3. 输入自然语言描述工作流
4. 系统解析并生成 Flow
5. 预览和调整（可选）
6. 保存
```

---

## 📁 项目结构

```
ai-work-platform/
├── frontend/                 # 前端项目（Tauri + Vue）
│   ├── src/
│   │   ├── components/      # Vue 组件
│   │   ├── views/           # 页面视图
│   │   ├── stores/          # Pinia 状态管理
│   │   ├── api/             # API 调用
│   │   └── utils/           # 工具函数
│   ├── package.json
│   └── vite.config.ts
│
├── backend/                  # 后端项目（FastAPI）
│   ├── app/
│   │   ├── api/             # API 路由
│   │   ├── models/          # 数据模型
│   │   ├── services/        # 业务逻辑
│   │   ├── core/            # 核心功能
│   │   │   ├── agent_engine.py    # Agent 引擎
│   │   │   ├── skill_manager.py   # 技能管理
│   │   │   ├── flow_engine.py     # Flow 引擎
│   │   │   └── model_manager.py   # Model 管理
│   │   ├── db/              # 数据库
│   │   └── utils/           # 工具函数
│   ├── agents/              # Agent 数据目录
│   ├── skills/              # 技能目录
│   │   ├── official/        # 官方技能（不可修改）
│   │   └── custom/          # 用户自定义技能
│   └── main.py
│
├── shared/                   # 共享类型定义
│   └── types.ts
│
├── tauri.conf.json           # Tauri 配置
├── package.json
└── README.md
```

---

## 🗓️ 开发计划（3 个月 MVP）

### 第 1 个月：基础设施

**Week 1-2：项目初始化**
- [ ] 搭建 Tauri + Vue 3 项目
- [ ] 搭建 FastAPI 后端项目
- [ ] 配置 IPC 通信
- [ ] 设计数据库表结构
- [ ] 实现基础 API 框架

**Week 3-4：核心模块**
- [ ] 实现用户设置模块
- [ ] 实现 Provider/Model 管理
- [ ] 实现基础存储引擎
- [ ] 实现日志监控系统

### 第 2 个月：Agent 和 Skill 系统

**Week 5-6：Agent 系统**
- [ ] 实现 Agent 自动生成（基于职位描述）
- [ ] 实现 Agent 配置文件管理
- [ ] 实现 Agent 工作引擎（基础版）
- [ ] 实现 Agent 列表和详情页面

**Week 7-8：Skill 系统**
- [ ] 实现官方技能（漫剧制作相关）
- [ ] 实现自定义技能生成（基于自然语言）
- [ ] 实现 Skill 加载和执行
- [ ] 实现 Skill 管理页面

### 第 3 个月：Flow 和集成

**Week 9-10：Flow 系统**
- [ ] 实现 Flow 自然语言解析
- [ ] 实现 Flow 编排和执行
- [ ] 实现 Flow 可视化展示
- [ ] 实现 Flow 管理页面

**Week 11-12：测试和打包**
- [ ] 端到端测试（漫剧制作完整流程）
- [ ] 性能优化
- [ ] Bug 修复
- [ ] 打包 Windows 安装程序
- [ ] 编写用户文档

---

## 🔧 技术难点和解决方案

### 难点 1：Agent 自动生成质量

**问题**：如何根据职位描述生成高质量的 Agent 配置？

**解决方案**：
- 使用 GPT-4 等强模型作为生成引擎
- 提供丰富的生成模板（脚本师、配音师、画面师等）
- 允许用户在生成后手动调整
- 支持保存自定义模板

### 难点 2：Flow 自然语言解析

**问题**：如何准确解析用户的工作流描述？

**解决方案**：
- 使用 LLM 解析自然语言为结构化 Flow
- 提供常用 Flow 模板
- 支持用户预览和调整解析结果
- 提供可视化 Flow 展示

### 难点 3：跨平台兼容性

**问题**：如何在 Windows、Linux、MacOS 上都能正常运行？

**解决方案**：
- 使用 Tauri（基于 Rust，跨平台）
- 后端 Python 使用虚拟环境隔离
- 工具调用提供平台适配层
- 充分测试各平台

### 难点 4：性能优化

**问题**：多个 Agent 并发执行时的性能问题？

**解决方案**：
- 使用异步 I/O（FastAPI + asyncio）
- LLM 调用使用连接池
- 缓存机制（Redis）
- 任务队列（Celery）

---

## 📊 成功指标

### MVP 成功标准
- [x] 可以一键安装（Windows 安装程序）
- [x] 用户首次设置流程完整
- [x] 可以创建 Agent（至少 3 个官方模板）
- [x] 可以创建 Flow（至少 2 个官方模板）
- [x] 可以执行完整的漫剧制作流程
- [x] 安装包体积 < 50MB
- [x] 启动时间 < 5 秒

---

## 🚀 后续规划

### v1.1（MVP 后 3 个月）
- 支持更多官方技能
- 支持更多 Flow 模板
- 性能优化
- Bug 修复

### v1.2（v1.1 后 3 个月）
- 支持更多 Provider（本地模型等）
- 支持导出/导入 Agent 和 Flow
- 支持团队协作
- Web 版本

### v2.0（长期目标）
- 插件市场
- Agent 市场
- SaaS 版本
- 企业版

---

## 📝 待确认事项

1. **产品名称**：需要确认正式的产品名称
2. **官方技能范围**：除了漫剧制作，还有哪些场景优先？
3. **技术栈确认**：是否同意使用 Tauri + Vue 3 + Python？
4. **开发资源**：是否有开发团队协助？
5. **时间线**：3 个月 MVP 是否合理？

---

**文档创建时间**：2026-02-15
**版本**：v1.0
**状态**：待确认
